{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ravul\\\\OneDrive\\\\Desktop\\\\zerodha-clone\\\\dashboard\\\\src\\\\components\\\\Home.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport TopBar from \"./TopBar\";\nimport Dashboard from \"./Dashboard\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Home = () => {\n  _s();\n  const [isVerified, setIsVerified] = useState(false);\n  useEffect(() => {\n    // Step 1: Read token from URL if present and store it\n    const urlParams = new URLSearchParams(window.location.search);\n    const tokenFromUrl = urlParams.get(\"token\");\n    if (tokenFromUrl) {\n      localStorage.setItem(\"token\", tokenFromUrl);\n      // Optional: remove token from URL after storing\n      window.history.replaceState(null, null, window.location.pathname);\n    }\n\n    // Step 2: Verify token\n    const verifyToken = async () => {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        window.location.href = \"http://localhost:3002\"; // redirect to login\n        return;\n      }\n      try {\n        const res = await fetch(\"http://localhost:3001/verify\", {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token}`\n          },\n          credentials: true\n        });\n        if (res.status === 200) {\n          setIsVerified(true);\n        } else {\n          window.location.href = \"http://localhost:3002\";\n        }\n      } catch (err) {\n        window.location.href = \"http://localhost:3002\";\n      }\n    };\n    verifyToken();\n  }, []);\n  if (!isVerified) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Verifying user...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 27\n  }, this);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(TopBar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dashboard, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Home, \"N22L0aq1gTWcmPbTD1S9Z+yMqd8=\");\n_c = Home;\nexport default Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useEffect","useState","TopBar","Dashboard","jsxDEV","_jsxDEV","Fragment","_Fragment","Home","_s","isVerified","setIsVerified","urlParams","URLSearchParams","window","location","search","tokenFromUrl","get","localStorage","setItem","history","replaceState","pathname","verifyToken","token","getItem","href","res","fetch","method","headers","Authorization","credentials","status","err","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/ravul/OneDrive/Desktop/zerodha-clone/dashboard/src/components/Home.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport TopBar from \"./TopBar\";\nimport Dashboard from \"./Dashboard\";\n\nconst Home = () => {\n  const [isVerified, setIsVerified] = useState(false);\n\n  useEffect(() => {\n    // Step 1: Read token from URL if present and store it\n    const urlParams = new URLSearchParams(window.location.search);\n    const tokenFromUrl = urlParams.get(\"token\");\n\n    if (tokenFromUrl) {\n      localStorage.setItem(\"token\", tokenFromUrl);\n      // Optional: remove token from URL after storing\n      window.history.replaceState(null, null, window.location.pathname);\n    }\n\n    // Step 2: Verify token\n    const verifyToken = async () => {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        window.location.href = \"http://localhost:3002\"; // redirect to login\n        return;\n      }\n\n      try {\n        const res = await fetch(\"http://localhost:3001/verify\", {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n          credentials: true,\n        });\n\n        if (res.status === 200) {\n          setIsVerified(true);\n        } else {\n          window.location.href = \"http://localhost:3002\";\n        }\n      } catch (err) {\n        window.location.href = \"http://localhost:3002\";\n      }\n    };\n\n    verifyToken();\n  }, []);\n\n  if (!isVerified) return <p>Verifying user...</p>;\n\n  return (\n    <>\n      <TopBar />\n      <Dashboard />\n    </>\n  );\n};\n\nexport default Home;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,MAAM,MAAM,UAAU;AAC7B,OAAOC,SAAS,MAAM,aAAa;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAEpC,MAAMC,IAAI,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACjB,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EAEnDD,SAAS,CAAC,MAAM;IACd;IACA,MAAMY,SAAS,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;IAC7D,MAAMC,YAAY,GAAGL,SAAS,CAACM,GAAG,CAAC,OAAO,CAAC;IAE3C,IAAID,YAAY,EAAE;MAChBE,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,YAAY,CAAC;MAC3C;MACAH,MAAM,CAACO,OAAO,CAACC,YAAY,CAAC,IAAI,EAAE,IAAI,EAAER,MAAM,CAACC,QAAQ,CAACQ,QAAQ,CAAC;IACnE;;IAEA;IACA,MAAMC,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,MAAMC,KAAK,GAAGN,YAAY,CAACO,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAI,CAACD,KAAK,EAAE;QACVX,MAAM,CAACC,QAAQ,CAACY,IAAI,GAAG,uBAAuB,CAAC,CAAC;QAChD;MACF;MAEA,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,8BAA8B,EAAE;UACtDC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACPC,aAAa,EAAE,UAAUP,KAAK;UAChC,CAAC;UACDQ,WAAW,EAAE;QACf,CAAC,CAAC;QAEF,IAAIL,GAAG,CAACM,MAAM,KAAK,GAAG,EAAE;UACtBvB,aAAa,CAAC,IAAI,CAAC;QACrB,CAAC,MAAM;UACLG,MAAM,CAACC,QAAQ,CAACY,IAAI,GAAG,uBAAuB;QAChD;MACF,CAAC,CAAC,OAAOQ,GAAG,EAAE;QACZrB,MAAM,CAACC,QAAQ,CAACY,IAAI,GAAG,uBAAuB;MAChD;IACF,CAAC;IAEDH,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,EAAE,CAAC;EAEN,IAAI,CAACd,UAAU,EAAE,oBAAOL,OAAA;IAAA+B,QAAA,EAAG;EAAiB;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAG,CAAC;EAEhD,oBACEnC,OAAA,CAAAE,SAAA;IAAA6B,QAAA,gBACE/B,OAAA,CAACH,MAAM;MAAAmC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eACVnC,OAAA,CAACF,SAAS;MAAAkC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAAA,eACb,CAAC;AAEP,CAAC;AAAC/B,EAAA,CApDID,IAAI;AAAAiC,EAAA,GAAJjC,IAAI;AAsDV,eAAeA,IAAI;AAAC,IAAAiC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}