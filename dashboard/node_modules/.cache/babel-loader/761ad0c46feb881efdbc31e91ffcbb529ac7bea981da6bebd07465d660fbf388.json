{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ravul\\\\OneDrive\\\\Desktop\\\\zerodha-clone\\\\dashboard\\\\src\\\\components\\\\Home.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport TopBar from \"./TopBar\";\nimport Dashboard from \"./Dashboard\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Home = () => {\n  _s();\n  const [isVerified, setIsVerified] = useState(false);\n  console.log(\"URL token:\", tokenFromUrl);\n  console.log(\"Stored token:\", localStorage.getItem(\"token\"));\n  useEffect(() => {\n    // Step 1: Read token from URL if present and store it\n    const urlParams = new URLSearchParams(window.location.search);\n    const tokenFromUrl = urlParams.get(\"token\");\n    if (tokenFromUrl) {\n      localStorage.setItem(\"token\", tokenFromUrl);\n      // Optional: remove token from URL after storing\n      window.history.replaceState(null, null, window.location.pathname);\n    }\n\n    // Step 2: Verify token\n    const verifyToken = async () => {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        window.location.href = \"http://localhost:3002\"; // redirect to login\n        return;\n      }\n      try {\n        const res = await fetch(\"http://localhost:3001/verify\", {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token}`\n          },\n          credentials: true\n        });\n        if (res.status === 200) {\n          setIsVerified(true);\n        } else {\n          window.location.href = \"http://localhost:3002\";\n        }\n      } catch (err) {\n        window.location.href = \"http://localhost:3002\";\n      }\n    };\n    verifyToken();\n  }, []);\n  if (!isVerified) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Verifying user...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 27\n  }, this);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(TopBar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dashboard, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Home, \"N22L0aq1gTWcmPbTD1S9Z+yMqd8=\");\n_c = Home;\nexport default Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useEffect","useState","TopBar","Dashboard","jsxDEV","_jsxDEV","Fragment","_Fragment","Home","_s","isVerified","setIsVerified","console","log","tokenFromUrl","localStorage","getItem","urlParams","URLSearchParams","window","location","search","get","setItem","history","replaceState","pathname","verifyToken","token","href","res","fetch","method","headers","Authorization","credentials","status","err","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/ravul/OneDrive/Desktop/zerodha-clone/dashboard/src/components/Home.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport TopBar from \"./TopBar\";\nimport Dashboard from \"./Dashboard\";\n\nconst Home = () => {\n  const [isVerified, setIsVerified] = useState(false);\n  console.log(\"URL token:\", tokenFromUrl);\nconsole.log(\"Stored token:\", localStorage.getItem(\"token\"));\n\n\n  useEffect(() => {\n    // Step 1: Read token from URL if present and store it\n    const urlParams = new URLSearchParams(window.location.search);\n    const tokenFromUrl = urlParams.get(\"token\");\n\n    if (tokenFromUrl) {\n      localStorage.setItem(\"token\", tokenFromUrl);\n      // Optional: remove token from URL after storing\n      window.history.replaceState(null, null, window.location.pathname);\n    }\n\n    // Step 2: Verify token\n    const verifyToken = async () => {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        window.location.href = \"http://localhost:3002\"; // redirect to login\n        return;\n      }\n\n      try {\n        const res = await fetch(\"http://localhost:3001/verify\", {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n          credentials: true,\n        });\n\n        if (res.status === 200) {\n          setIsVerified(true);\n        } else {\n          window.location.href = \"http://localhost:3002\";\n        }\n      } catch (err) {\n        window.location.href = \"http://localhost:3002\";\n      }\n    };\n\n    verifyToken();\n  }, []);\n\n  if (!isVerified) return <p>Verifying user...</p>;\n\n  return (\n    <>\n      <TopBar />\n      <Dashboard />\n    </>\n  );\n};\n\nexport default Home;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,MAAM,MAAM,UAAU;AAC7B,OAAOC,SAAS,MAAM,aAAa;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAEpC,MAAMC,IAAI,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACjB,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EACnDW,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEC,YAAY,CAAC;EACzCF,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEE,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC;EAGzDhB,SAAS,CAAC,MAAM;IACd;IACA,MAAMiB,SAAS,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;IAC7D,MAAMP,YAAY,GAAGG,SAAS,CAACK,GAAG,CAAC,OAAO,CAAC;IAE3C,IAAIR,YAAY,EAAE;MAChBC,YAAY,CAACQ,OAAO,CAAC,OAAO,EAAET,YAAY,CAAC;MAC3C;MACAK,MAAM,CAACK,OAAO,CAACC,YAAY,CAAC,IAAI,EAAE,IAAI,EAAEN,MAAM,CAACC,QAAQ,CAACM,QAAQ,CAAC;IACnE;;IAEA;IACA,MAAMC,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,MAAMC,KAAK,GAAGb,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAI,CAACY,KAAK,EAAE;QACVT,MAAM,CAACC,QAAQ,CAACS,IAAI,GAAG,uBAAuB,CAAC,CAAC;QAChD;MACF;MAEA,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,8BAA8B,EAAE;UACtDC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACPC,aAAa,EAAE,UAAUN,KAAK;UAChC,CAAC;UACDO,WAAW,EAAE;QACf,CAAC,CAAC;QAEF,IAAIL,GAAG,CAACM,MAAM,KAAK,GAAG,EAAE;UACtBzB,aAAa,CAAC,IAAI,CAAC;QACrB,CAAC,MAAM;UACLQ,MAAM,CAACC,QAAQ,CAACS,IAAI,GAAG,uBAAuB;QAChD;MACF,CAAC,CAAC,OAAOQ,GAAG,EAAE;QACZlB,MAAM,CAACC,QAAQ,CAACS,IAAI,GAAG,uBAAuB;MAChD;IACF,CAAC;IAEDF,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,EAAE,CAAC;EAEN,IAAI,CAACjB,UAAU,EAAE,oBAAOL,OAAA;IAAAiC,QAAA,EAAG;EAAiB;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAG,CAAC;EAEhD,oBACErC,OAAA,CAAAE,SAAA;IAAA+B,QAAA,gBACEjC,OAAA,CAACH,MAAM;MAAAqC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eACVrC,OAAA,CAACF,SAAS;MAAAoC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAAA,eACb,CAAC;AAEP,CAAC;AAACjC,EAAA,CAvDID,IAAI;AAAAmC,EAAA,GAAJnC,IAAI;AAyDV,eAAeA,IAAI;AAAC,IAAAmC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}