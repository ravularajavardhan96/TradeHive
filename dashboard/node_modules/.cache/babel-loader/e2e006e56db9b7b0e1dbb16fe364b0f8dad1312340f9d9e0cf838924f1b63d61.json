{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ravul\\\\OneDrive\\\\Desktop\\\\zerodha-clone\\\\dashboard\\\\src\\\\components\\\\Home.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport TopBar from \"./TopBar\";\nimport Dashboard from \"./Dashboard\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Home = () => {\n  _s();\n  const [isVerified, setIsVerified] = useState(false);\n  useEffect(() => {\n    // ✅ Declare and use tokenFromUrl inside useEffect\n    const urlParams = new URLSearchParams(window.location.search);\n    const tokenFromUrl = urlParams.get(\"token\");\n    console.log(\"URL token:\", tokenFromUrl); // ✅ Safe here\n\n    if (tokenFromUrl) {\n      localStorage.setItem(\"token\", tokenFromUrl);\n      // ✅ Clean the URL after saving token\n      window.history.replaceState(null, null, window.location.pathname);\n    }\n    const verifyToken = async () => {\n      const token = localStorage.getItem(\"token\");\n      console.log(\"Stored token:\", token); // ✅ Helpful for debugging\n\n      if (!token) {\n        window.location.href = \"http://localhost:3002\";\n        return;\n      }\n      try {\n        const res = await fetch(\"http://localhost:3001/verify\", {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token}`\n          },\n          credentials: \"include\" // Optional but good if you're using cookies\n        });\n        const data = await res.json();\n        console.log(\"Verify API response:\", res.status, data);\n        if (res.status === 200) {\n          setIsVerified(true);\n        } else {\n          window.location.href = \"http://localhost:3002\";\n        }\n      } catch (err) {\n        console.error(\"Verification failed:\", err);\n        window.location.href = \"http://localhost:3002\";\n      }\n    };\n    verifyToken();\n  }, []);\n  if (!isVerified) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Verifying user...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 27\n  }, this);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(TopBar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dashboard, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Home, \"N22L0aq1gTWcmPbTD1S9Z+yMqd8=\");\n_c = Home;\nexport default Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useEffect","useState","TopBar","Dashboard","jsxDEV","_jsxDEV","Fragment","_Fragment","Home","_s","isVerified","setIsVerified","urlParams","URLSearchParams","window","location","search","tokenFromUrl","get","console","log","localStorage","setItem","history","replaceState","pathname","verifyToken","token","getItem","href","res","fetch","method","headers","Authorization","credentials","data","json","status","err","error","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/ravul/OneDrive/Desktop/zerodha-clone/dashboard/src/components/Home.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport TopBar from \"./TopBar\";\nimport Dashboard from \"./Dashboard\";\n\nconst Home = () => {\n  const [isVerified, setIsVerified] = useState(false);\n\n  useEffect(() => {\n    // ✅ Declare and use tokenFromUrl inside useEffect\n    const urlParams = new URLSearchParams(window.location.search);\n    const tokenFromUrl = urlParams.get(\"token\");\n\n    console.log(\"URL token:\", tokenFromUrl); // ✅ Safe here\n\n    if (tokenFromUrl) {\n      localStorage.setItem(\"token\", tokenFromUrl);\n      // ✅ Clean the URL after saving token\n      window.history.replaceState(null, null, window.location.pathname);\n    }\n\n    const verifyToken = async () => {\n      const token = localStorage.getItem(\"token\");\n      console.log(\"Stored token:\", token); // ✅ Helpful for debugging\n\n      if (!token) {\n        window.location.href = \"http://localhost:3002\";\n        return;\n      }\n\n      try {\n        const res = await fetch(\"http://localhost:3001/verify\", {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n          credentials: \"include\", // Optional but good if you're using cookies\n        });\n\n        const data = await res.json();\n        console.log(\"Verify API response:\", res.status, data);\n\n        if (res.status === 200) {\n          setIsVerified(true);\n        } else {\n          window.location.href = \"http://localhost:3002\";\n        }\n      } catch (err) {\n        console.error(\"Verification failed:\", err);\n        window.location.href = \"http://localhost:3002\";\n      }\n    };\n\n    verifyToken();\n  }, []);\n\n  if (!isVerified) return <p>Verifying user...</p>;\n\n  return (\n    <>\n      <TopBar />\n      <Dashboard />\n    </>\n  );\n};\n\nexport default Home;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,MAAM,MAAM,UAAU;AAC7B,OAAOC,SAAS,MAAM,aAAa;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAEpC,MAAMC,IAAI,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACjB,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EAEnDD,SAAS,CAAC,MAAM;IACd;IACA,MAAMY,SAAS,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;IAC7D,MAAMC,YAAY,GAAGL,SAAS,CAACM,GAAG,CAAC,OAAO,CAAC;IAE3CC,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEH,YAAY,CAAC,CAAC,CAAC;;IAEzC,IAAIA,YAAY,EAAE;MAChBI,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEL,YAAY,CAAC;MAC3C;MACAH,MAAM,CAACS,OAAO,CAACC,YAAY,CAAC,IAAI,EAAE,IAAI,EAAEV,MAAM,CAACC,QAAQ,CAACU,QAAQ,CAAC;IACnE;IAEA,MAAMC,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,MAAMC,KAAK,GAAGN,YAAY,CAACO,OAAO,CAAC,OAAO,CAAC;MAC3CT,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEO,KAAK,CAAC,CAAC,CAAC;;MAErC,IAAI,CAACA,KAAK,EAAE;QACVb,MAAM,CAACC,QAAQ,CAACc,IAAI,GAAG,uBAAuB;QAC9C;MACF;MAEA,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,8BAA8B,EAAE;UACtDC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACPC,aAAa,EAAE,UAAUP,KAAK;UAChC,CAAC;UACDQ,WAAW,EAAE,SAAS,CAAE;QAC1B,CAAC,CAAC;QAEF,MAAMC,IAAI,GAAG,MAAMN,GAAG,CAACO,IAAI,CAAC,CAAC;QAC7BlB,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEU,GAAG,CAACQ,MAAM,EAAEF,IAAI,CAAC;QAErD,IAAIN,GAAG,CAACQ,MAAM,KAAK,GAAG,EAAE;UACtB3B,aAAa,CAAC,IAAI,CAAC;QACrB,CAAC,MAAM;UACLG,MAAM,CAACC,QAAQ,CAACc,IAAI,GAAG,uBAAuB;QAChD;MACF,CAAC,CAAC,OAAOU,GAAG,EAAE;QACZpB,OAAO,CAACqB,KAAK,CAAC,sBAAsB,EAAED,GAAG,CAAC;QAC1CzB,MAAM,CAACC,QAAQ,CAACc,IAAI,GAAG,uBAAuB;MAChD;IACF,CAAC;IAEDH,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,EAAE,CAAC;EAEN,IAAI,CAAChB,UAAU,EAAE,oBAAOL,OAAA;IAAAoC,QAAA,EAAG;EAAiB;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAG,CAAC;EAEhD,oBACExC,OAAA,CAAAE,SAAA;IAAAkC,QAAA,gBACEpC,OAAA,CAACH,MAAM;MAAAwC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eACVxC,OAAA,CAACF,SAAS;MAAAuC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAAA,eACb,CAAC;AAEP,CAAC;AAACpC,EAAA,CA3DID,IAAI;AAAAsC,EAAA,GAAJtC,IAAI;AA6DV,eAAeA,IAAI;AAAC,IAAAsC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}